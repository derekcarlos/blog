---
import Base from "@/layouts/Base.astro";
import Breadcrumb from "@/components/Breadcrumb.astro";

interface Props {
  title?: string;
  description?: string;
  /** 文章/分享图绝对 URL（如博客封面） */
  image?: string;
  /** 分享图描述 */
  imageAlt?: string;
  /** ISO 日期时间，文章发布时间 */
  articlePublishedTime?: string;
  /** ISO 日期时间，文章修改时间 */
  articleModifiedTime?: string;
  /** 文章作者名 */
  articleAuthor?: string;
  /** 面包屑 [{ name, url }] */
  breadcrumbs?: { name: string; url: string }[];
  /** 加宽主区域以容纳侧栏，正文保持 800px */
  contentWide?: boolean;
  frontmatter?: undefined;
}

const {
  title,
  description,
  image,
  imageAlt,
  articlePublishedTime,
  articleModifiedTime,
  articleAuthor,
  breadcrumbs,
  contentWide,
} = Astro.props.frontmatter || Astro.props;
---

<Base
  title={title}
  description={description}
  type="article"
  image={image}
  imageAlt={imageAlt}
  articlePublishedTime={articlePublishedTime}
  articleModifiedTime={articleModifiedTime}
  articleAuthor={articleAuthor}
  breadcrumbs={breadcrumbs}
  contentWide={contentWide}
>
  {breadcrumbs && breadcrumbs.length > 0 && (
    <Breadcrumb items={breadcrumbs} />
  )}
  <article>
    <slot />
  </article>
</Base>

<style>
  article {
    > * {
      margin-block: 1.2em 0;
      margin-inline: 0;
    }
    p {
      font-weight: 400;
    }
    h2 {
      margin-block: 3em 0;
      padding-block-end: 0.2em;
      border-inline-start: 4px solid var(--color-accent);
      padding-inline-start: var(--sp-s);
      line-height: 1.4;
      font-size: 1.6rem;
    }
    h3 {
      margin-block: 2em 0;
      padding-block-end: 0.2em;
      line-height: 1.4;
      font-size: 1.4rem;
      border-block-end: 1px solid
        color-mix(in srgb, var(--color-main) 10%, transparent);
    }
    h4 {
      margin-block: 2em -0.4em;
      line-height: 1.4;
      font-size: 1.1rem;
    }
    ul {
      list-style: disc;
      padding-inline-start: 1.5em;
    }
    ol {
      list-style: decimal;
      padding-inline-start: 1.5em;
    }
    li {
      margin-block: 0 0.5em;
      line-height: 1.4;
    }
    :not(pre) code {
      font-family: Consolas, "Courier New", Courier, Monaco, monospace;
      color: var(--color-theme);
      background-color: color-mix(in srgb, var(--color-main) 8%, transparent);
      padding-block: 0.2em;
      padding-inline: 0.4em;
      border-radius: 2px;
      font-size: 0.9rem;
    }
    blockquote {
      font-style: italic;
      color: color-mix(in srgb, var(--color-main) 80%, transparent);
      background: color-mix(in srgb, var(--color-main) 5%, transparent);
      padding: 1em;
      border-inline-start: 2px solid
        color-mix(in srgb, var(--color-main) 10%, transparent);
    }

    /* GitHub-style callouts/alerts */
    .markdown-alert {
      font-style: normal;
      padding: 1em;
      border-radius: 8px;
      border-inline-start: 4px solid;
      margin-block: 1.5em 0;
    }

    .markdown-alert > .markdown-alert-title {
      display: flex;
      align-items: center;
      gap: 0.5em;
      font-weight: 700;
      font-size: 0.95em;
      margin-block: 0 0.5em;
      letter-spacing: 0.02em;
    }

    .markdown-alert > .markdown-alert-title svg {
      flex-shrink: 0;
      width: 1.1em;
      height: 1.1em;
      fill: currentColor;
      opacity: 0.9;
    }

    .markdown-alert > p {
      margin-block: 0.5em 0;
      color: var(--color-main);
      font-weight: 400;
    }

    .markdown-alert > p:last-child {
      margin-block-end: 0;
    }

    /* NOTE - Blue/Cyan (using theme color) */
    .markdown-alert-note {
      background: color-mix(in srgb, var(--color-theme) 10%, transparent);
      border-color: var(--color-theme);
    }

    .markdown-alert-note > .markdown-alert-title {
      color: var(--color-theme);
    }

    /* TIP - Green */
    .markdown-alert-tip {
      background: color-mix(in srgb, var(--color-tip) 10%, transparent);
      border-color: var(--color-tip);
    }

    .markdown-alert-tip > .markdown-alert-title {
      color: var(--color-tip);
    }

    /* IMPORTANT - Purple/Magenta */
    .markdown-alert-important {
      background: color-mix(in srgb, var(--color-important) 10%, transparent);
      border-color: var(--color-important);
    }

    .markdown-alert-important > .markdown-alert-title {
      color: var(--color-important);
    }

    /* WARNING - Orange/Yellow */
    .markdown-alert-warning {
      background: color-mix(in srgb, var(--color-warning) 10%, transparent);
      border-color: var(--color-warning);
    }

    .markdown-alert-warning > .markdown-alert-title {
      color: var(--color-warning);
    }

    /* CAUTION - Red (using existing --color-caution variable) */
    .markdown-alert-caution {
      background: color-mix(in srgb, var(--color-caution) 10%, transparent);
      border-color: var(--color-caution);
    }

    .markdown-alert-caution > .markdown-alert-title {
      color: var(--color-caution);
    }
    a {
      text-decoration: underline;
      color: var(--color-theme);
      font-weight: 500;
    }
    img {
      border-radius: 4px;
      background-color: color-mix(in srgb, var(--color-main) 10%, transparent);
    }
    pre {
      direction: ltr;
      padding: 1em;
      border-radius: 4px;
      border: 2px solid color-mix(in srgb, var(--color-main) 20%, transparent);
    }
  }
</style>
